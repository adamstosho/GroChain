{
  "openapi": "3.0.3",
  "info": {
    "title": "GroChain Backend API",
    "version": "1.0.0",
    "description": "Comprehensive API documentation for GroChain backend."
  },
  "servers": [
    { "url": "http://localhost:5000" }
  ],
  "components": {
    "securitySchemes": {
      "bearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "JWT"
      }
    },
    "schemas": {
      "User": {
        "type": "object",
        "properties": {
          "id": { "type": "string" },
          "name": { "type": "string" },
          "email": { "type": "string", "format": "email" },
          "phone": { "type": "string" },
          "role": { "type": "string", "enum": ["farmer","partner","admin","buyer"] },
          "status": { "type": "string", "enum": ["active","inactive","suspended"] }
        }
      },
      "Harvest": {
        "type": "object",
        "properties": {
          "_id": { "type": "string" },
          "farmer": { "type": "string" },
          "cropType": { "type": "string" },
          "quantity": { "type": "number" },
          "unit": { "type": "string", "enum": ["kg","tons","pieces","bundles","bags","crates"] },
          "date": { "type": "string", "format": "date-time" },
          "geoLocation": { "type": "object", "properties": { "lat": {"type":"number"}, "lng": {"type":"number"} } },
          "batchId": { "type": "string" },
          "qrData": { "type": "string" },
          "quality": { "type": "string", "enum": ["excellent","good","fair","poor"] }
        }
      },
      "Listing": {
        "type": "object",
        "properties": {
          "_id": { "type": "string" },
          "product": { "type": "string" },
          "price": { "type": "number" },
          "quantity": { "type": "number" },
          "farmer": { "type": "string" },
          "partner": { "type": "string" },
          "images": { "type": "array", "items": { "type": "string" } },
          "status": { "type": "string", "enum": ["active","sold","removed"] }
        }
      },
      "Order": {
        "type": "object",
        "properties": {
          "_id": { "type": "string" },
          "buyer": { "type": "string" },
          "items": { "type": "array", "items": { "type": "object", "properties": {
            "listing": { "type": "string" },
            "quantity": { "type": "number" },
            "price": { "type": "number" }
          } } },
          "total": { "type": "number" },
          "status": { "type": "string", "enum": ["pending","paid","delivered","cancelled","completed"] }
        }
      }
    }
  },
  "security": [ { "bearerAuth": [] } ],
  "paths": {
    "/health": {
      "get": { "summary": "Health check", "responses": { "200": { "description": "OK" } } }
    },
    "/metrics": { "get": { "summary": "Prometheus metrics", "responses": { "200": { "description": "OK" } } } },

    "/api/auth/register": { "post": { "summary": "Register user", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "name": {"type":"string"}, "email": {"type":"string"}, "phone": {"type":"string"}, "password": {"type":"string"}, "role": {"type":"string"} }, "required": ["name","email","phone","password"] } } } }, "responses": { "201": { "description": "Created" } } } },
    "/api/auth/login": { "post": { "summary": "Login", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "email": {"type":"string"}, "password": {"type":"string"} }, "required": ["email","password"] } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/auth/refresh": { "post": { "summary": "Refresh tokens", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "refreshToken": {"type":"string"} }, "required": ["refreshToken"] } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/auth/forgot-password": { "post": { "summary": "Forgot password", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "email": {"type":"string"} }, "required": ["email"] } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/auth/reset-password": { "post": { "summary": "Reset password", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "token": {"type":"string"}, "password": {"type":"string"} }, "required": ["token","password"] } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/auth/verify-email": { "post": { "summary": "Verify email", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "token": {"type":"string"} }, "required": ["token"] } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/auth/send-sms-otp": { "post": { "summary": "Send SMS OTP", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "phone": {"type":"string"} }, "required": ["phone"] } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/auth/verify-sms-otp": { "post": { "summary": "Verify SMS OTP", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "phone": {"type":"string"}, "otp": {"type":"string"} }, "required": ["phone","otp"] } } } }, "responses": { "200": { "description": "OK" } } } },

    "/api/farmers/profile/me": { "get": { "summary": "Get my farmer profile", "responses": { "200": { "description": "OK" } } }, "put": { "summary": "Update my farmer profile", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "name": {"type":"string"}, "phone": {"type":"string"} } } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/farmers/preferences/me": { "get": { "summary": "Get my farmer preferences", "responses": { "200": { "description": "OK" } } }, "put": { "summary": "Update my farmer preferences", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "notifications": {"type":"object"} } } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/farmers/settings/me": { "get": { "summary": "Get my farmer settings", "responses": { "200": { "description": "OK" } } }, "put": { "summary": "Update my farmer settings", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object" } } } }, "responses": { "200": { "description": "OK" } } } },

    "/api/harvests": { "get": { "summary": "List my harvests", "parameters": [ {"name":"cropType","in":"query","schema":{"type":"string"}}, {"name":"page","in":"query","schema":{"type":"integer"}}, {"name":"limit","in":"query","schema":{"type":"integer"}} ], "responses": { "200": { "description": "OK" } } }, "post": { "summary": "Create harvest", "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Harvest" } } } }, "responses": { "201": { "description": "Created" } } } },
    "/api/harvests/{batchId}": { "get": { "summary": "Get harvest provenance", "parameters": [ {"name":"batchId","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" }, "404": { "description": "Not found" } } } },
    "/api/harvests/verify/{batchId}": { "get": { "summary": "Public QR verification", "parameters": [ {"name":"batchId","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" }, "404": { "description": "Not found" } } } },

    "/api/marketplace/listings": { "get": { "summary": "List marketplace listings", "responses": { "200": { "description": "OK" } } }, "post": { "summary": "Create listing", "requestBody": { "required": true, "content": { "application/json": { "schema": { "$ref": "#/components/schemas/Listing" } } } }, "responses": { "201": { "description": "Created" } } } },
    "/api/marketplace/listings/{id}": { "get": { "summary": "Get listing", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" }, "404": { "description": "Not found" } } }, "patch": { "summary": "Update listing", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object" } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/marketplace/listings/{id}/unpublish": { "patch": { "summary": "Unpublish listing", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/marketplace/orders": { "post": { "summary": "Create order", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "buyer": {"type":"string"}, "items": {"type":"array","items":{"type":"object","properties":{"listing":{"type":"string"},"quantity":{"type":"integer"}}}} }, "required": ["buyer","items"] } } } }, "responses": { "201": { "description": "Created" } } } },
    "/api/marketplace/orders/{id}": { "get": { "summary": "Get order details", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } }, "patch": { "summary": "Update order status", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "status": {"type":"string"} } } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/marketplace/orders/{id}/cancel": { "patch": { "summary": "Cancel order", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/marketplace/orders/{id}/tracking": { "get": { "summary": "Track order", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/marketplace/search-suggestions": { "get": { "summary": "Search suggestions", "parameters": [ {"name":"q","in":"query","schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/marketplace/favorites/{userId}": { "get": { "summary": "Get favorites", "parameters": [ {"name":"userId","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/marketplace/favorites": { "post": { "summary": "Add to favorites", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "userId": {"type":"string"}, "listingId": {"type":"string"} }, "required": ["userId","listingId"] } } } }, "responses": { "201": { "description": "Created" } } } },
    "/api/marketplace/favorites/{userId}/{listingId}": { "delete": { "summary": "Remove from favorites", "parameters": [ {"name":"userId","in":"path","required":true,"schema":{"type":"string"}}, {"name":"listingId","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },

    "/api/payments/config": { "get": { "summary": "Get Paystack config", "responses": { "200": { "description": "OK" } } } },
    "/api/payments/initialize": { "post": { "summary": "Initialize order payment", "requestBody": { "required": true, "content": { "application/json": { "schema": { "type": "object", "properties": { "orderId": {"type":"string"}, "email": {"type":"string"} }, "required": ["orderId","email"] } } } }, "responses": { "200": { "description": "OK" } } } },
    "/api/payments/verify": { "post": { "summary": "Paystack webhook verify", "responses": { "200": { "description": "OK" } } } },

    "/api/partners/test": { "get": { "summary": "Partner test endpoint", "responses": { "200": { "description": "OK" } } } },
    "/api/partners": { "get": { "summary": "List partners", "responses": { "200": { "description": "OK" } } }, "post": { "summary": "Create partner", "responses": { "201": { "description": "Created" } } } },
    "/api/partners/{id}": { "get": { "summary": "Get partner", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" }, "404": { "description": "Not found" } } }, "put": { "summary": "Update partner", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } }, "delete": { "summary": "Delete partner", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/partners/{id}/metrics": { "get": { "summary": "Partner metrics", "parameters": [ {"name":"id","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },

    "/api/notifications/send": { "post": { "summary": "Send notification", "responses": { "200": { "description": "OK" } } } },
    "/api/notifications/send-bulk": { "post": { "summary": "Send bulk notifications", "responses": { "200": { "description": "OK" } } } },
    "/api/notifications/preferences": { "get": { "summary": "Get my notification preferences", "responses": { "200": { "description": "OK" } } }, "put": { "summary": "Update my notification preferences", "responses": { "200": { "description": "OK" } } } },
    "/api/notifications/push-token": { "put": { "summary": "Update push token", "responses": { "200": { "description": "OK" } } } },
    "/api/notifications/transaction": { "post": { "summary": "Send transaction notification", "responses": { "200": { "description": "OK" } } } },
    "/api/notifications/harvest": { "post": { "summary": "Send harvest notification", "responses": { "200": { "description": "OK" } } } },
    "/api/notifications/marketplace": { "post": { "summary": "Send marketplace notification", "responses": { "200": { "description": "OK" } } } },

    "/api/analytics/dashboard": { "get": { "summary": "Dashboard metrics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/farmers": { "get": { "summary": "Farmer analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/transactions": { "get": { "summary": "Transaction analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/harvests": { "get": { "summary": "Harvest analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/marketplace": { "get": { "summary": "Marketplace analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/fintech": { "get": { "summary": "Fintech analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/impact": { "get": { "summary": "Impact analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/partners": { "get": { "summary": "Partner analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/weather": { "get": { "summary": "Weather analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/report": { "post": { "summary": "Generate analytics report", "responses": { "201": { "description": "Created" } } } },
    "/api/analytics/reports": { "get": { "summary": "Get analytics reports", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/export": { "get": { "summary": "Export analytics data", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/compare": { "post": { "summary": "Comparative analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/regional": { "post": { "summary": "Regional analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/predictive": { "get": { "summary": "Predictive analytics", "responses": { "200": { "description": "OK" } } } },
    "/api/analytics/summary": { "get": { "summary": "Analytics summary", "responses": { "200": { "description": "OK" } } } },

    "/api/weather/current": { "get": { "summary": "Current weather", "parameters": [ {"name":"lat","in":"query","required":true,"schema":{"type":"number"}}, {"name":"lng","in":"query","required":true,"schema":{"type":"number"}}, {"name":"city","in":"query","required":true,"schema":{"type":"string"}}, {"name":"state","in":"query","required":true,"schema":{"type":"string"}}, {"name":"country","in":"query","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/weather/forecast": { "get": { "summary": "Weather forecast", "parameters": [ {"name":"lat","in":"query","required":true,"schema":{"type":"number"}}, {"name":"lng","in":"query","required":true,"schema":{"type":"number"}}, {"name":"city","in":"query","required":true,"schema":{"type":"string"}}, {"name":"state","in":"query","required":true,"schema":{"type":"string"}}, {"name":"country","in":"query","required":true,"schema":{"type":"string"}}, {"name":"days","in":"query","schema":{"type":"integer"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/weather/agricultural-insights": { "get": { "summary": "Agricultural insights", "parameters": [ {"name":"lat","in":"query","required":true,"schema":{"type":"number"}}, {"name":"lng","in":"query","required":true,"schema":{"type":"number"}}, {"name":"city","in":"query","required":true,"schema":{"type":"string"}}, {"name":"state","in":"query","required":true,"schema":{"type":"string"}}, {"name":"country","in":"query","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/weather/alerts": { "get": { "summary": "Weather alerts", "parameters": [ {"name":"lat","in":"query","required":true,"schema":{"type":"number"}}, {"name":"lng","in":"query","required":true,"schema":{"type":"number"}}, {"name":"city","in":"query","required":true,"schema":{"type":"string"}}, {"name":"state","in":"query","required":true,"schema":{"type":"string"}}, {"name":"country","in":"query","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/weather/historical": { "get": { "summary": "Historical weather", "parameters": [ {"name":"lat","in":"query","required":true,"schema":{"type":"number"}}, {"name":"lng","in":"query","required":true,"schema":{"type":"number"}}, {"name":"city","in":"query","required":true,"schema":{"type":"string"}}, {"name":"state","in":"query","required":true,"schema":{"type":"string"}}, {"name":"country","in":"query","required":true,"schema":{"type":"string"}}, {"name":"startDate","in":"query","required":true,"schema":{"type":"string"}}, {"name":"endDate","in":"query","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/weather/coordinates/{lat}/{lng}": { "get": { "summary": "Weather by coordinates", "parameters": [ {"name":"lat","in":"path","required":true,"schema":{"type":"number"}}, {"name":"lng","in":"path","required":true,"schema":{"type":"number"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/weather/statistics/{region}": { "get": { "summary": "Weather statistics", "parameters": [ {"name":"region","in":"path","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/weather/regional-alerts": { "get": { "summary": "Regional alerts", "parameters": [ {"name":"region","in":"query","required":true,"schema":{"type":"string"}}, {"name":"severity","in":"query","schema":{"type":"string"}}, {"name":"type","in":"query","schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } },
    "/api/weather/climate-summary": { "get": { "summary": "Climate summary", "parameters": [ {"name":"lat","in":"query","required":true,"schema":{"type":"number"}}, {"name":"lng","in":"query","required":true,"schema":{"type":"number"}}, {"name":"city","in":"query","required":true,"schema":{"type":"string"}}, {"name":"state","in":"query","required":true,"schema":{"type":"string"}}, {"name":"country","in":"query","required":true,"schema":{"type":"string"}} ], "responses": { "200": { "description": "OK" } } } }
  }
}

